<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <title>Cadastro | XDRONES</title>
  
  <link rel="stylesheet" href="assets/css/style.css">
  <link rel="stylesheet" href="assets/css/header.css">
  <link rel="stylesheet" href="assets/css/footer.css">
  <link rel="stylesheet" href="assets/css/cart.css">
  <link rel="stylesheet" href="assets/css/contato.css">
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
</head>
<body>

  <div data-include="components/header.html"></div>

  <main>
    <section class="login-section">
      <div class="login-container">

        <h2>Criar sua conta</h2>
        <p>Preencha os dados para se cadastrar</p>

        <form class="login-form cadastro-steps" id="cadastroForm" novalidate>

          <p id="cadMsg" class="form-message" aria-live="polite" style="display:none;"></p>

          <div class="cadastro-tabs">
            <button type="button" class="tab active" onclick="trocarEtapa(1)">Conta</button>
            <button type="button" class="tab" onclick="trocarEtapa(2)">Endereço</button>
          </div>

            <div class="cadastro-etapa active" id="etapa1">
            <label>Nome completo</label>
            <input type="text" id="nome" placeholder="Seu nome completo" required>

            <label>Email</label>
            <input type="email" id="email" placeholder="seu@email.com" required >

            <label>Senha</label>
            <input type="password" id="senha" placeholder="Digite sua senha" required>

            <div class="pw-rules" id="passwordRules">
              <strong>Regras para criar sua senha:</strong>
              <ul>
                <li id="rule-length" class="invalid">Ao menos 8 caracteres</li>
                <li id="rule-uppercase" class="invalid">Ao menos 1 letra maiúscula (A-Z)</li>
                <li id="rule-lowercase" class="invalid">Ao menos 1 letra minúscula (a-z)</li>
                <li id="rule-number" class="invalid">Ao menos 1 número (0-9)</li>
                <li id="rule-special" class="invalid">Ao menos 1 caractere especial (ex: !@#$%&*)</li>
              </ul>
            </div>

            <label>Confirmar senha</label>
            <input type="password" id="confirmarSenha" placeholder="Confirmar sua senha" required>

            <button type="button" id="btnNext" class="btn" onclick="trocarEtapa(2)" disabled>
              Próxima etapa →
            </button>
          </div>

            <div class="cadastro-etapa" id="etapa2">
            <label>Endereço</label>
            <input type="text" id="endereco" placeholder="Rua, Avenida, etc">

            <label>CPF</label>
            <input type="text" id="cpf" placeholder="000.000.000-00" maxlength="14">

            <label>CEP</label>
            <input type="text" id="cep" placeholder="00000-000">

            <label>Número</label>
            <input type="text" id="numero">

            <label>Referência</label>
            <input type="text" id="referencia" placeholder="Próx. ao mercado">

            <button type="submit" class="btn">
              Finalizar cadastro
            </button>
          </div>

          <div class="login-links">
            <a href="login.html">Já tem conta? Entrar</a>
          </div>

        </form>

      </div>
    </section>
  </main>

  <div data-include="components/footer.html"></div>

  <script src="assets/js/cadastro.js"></script>

  <script>
    function loadHTML(selector, url) {
      fetch(url)
        .then(response => response.text())
        .then(data => {
          document.querySelector(selector).innerHTML = data;
        })
        .catch(err => console.error(err));
    }

    // Formata CPF automaticamente enquanto digita (XXX.XXX.XXX-XX)
    document.addEventListener('DOMContentLoaded', () => {
      loadHTML('div[data-include="components/header.html"]', 'components/header.html');
      loadHTML('div[data-include="components/footer.html"]', 'components/footer.html');

      const cpfInput = document.getElementById('cpf');
      if (cpfInput) {
        cpfInput.addEventListener('input', (e) => {
          let value = e.target.value.replace(/[^\d]/g, ''); // Remove tudo que não é número
          value = value.substring(0, 11); // Limita a 11 dígitos
          
          // Formata como XXX.XXX.XXX-XX
          if (value.length > 0) {
            if (value.length <= 3) {
              e.target.value = value;
            } else if (value.length <= 6) {
              e.target.value = value.substring(0, 3) + '.' + value.substring(3);
            } else if (value.length <= 9) {
              e.target.value = value.substring(0, 3) + '.' + value.substring(3, 6) + '.' + value.substring(6);
            } else {
              e.target.value = value.substring(0, 3) + '.' + value.substring(3, 6) + '.' + value.substring(6, 9) + '-' + value.substring(9);
            }
          }
        });
      }
    });
  </script>

</body>
</html>